<link
  href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>

<div class="habitacion-container">
  <div class="filtros-container">
    <mat-form-field appearance="outline" class="filtro-input">
      <mat-label>Buscar por N° Habitación (3 dígitos)</mat-label>
      <input
        matInput
        type="text"
        [(ngModel)]="filtroId"
        (input)="aplicarFiltros()"
        placeholder="Ej: 101, 205, etc."
        maxlength="3"
        #idInput="ngModel"
        pattern="[0-9]{3}"
      />
      <mat-icon matSuffix>search</mat-icon>
      <mat-hint *ngIf="filtroId && !esIdValido()">
        Ingrese exactamente 3 dígitos numéricos
      </mat-hint>
      <mat-error *ngIf="idInput.errors?.['pattern']">
        Solo se permiten números (3 dígitos)
      </mat-error>
    </mat-form-field>

    <div
      *ngIf="huespedResponseFiltrados.length === 0 && filtroId && esIdValido()"
      style="color: #d4af37; margin: 1rem 0; font-size: 1.6rem"
    >
      No se encontraron habitaciones con el número {{ filtroId }}.
      <div *ngIf="huespedResponse.length > 0">
        Habitaciones existentes:
        <span *ngFor="let h of huespedResponse | slice : 0 : 5">
          {{ h.habitacionAsignada.id_Rooms }}
        </span>
        {{ huespedResponse.length > 5 ? "..." : "" }}
      </div>
    </div>

    <mat-form-field appearance="outline" class="filtro-input">
      <mat-label>Rango de fechas</mat-label>
      <mat-date-range-input [rangePicker]="picker">
        <input
          matStartDate
          [(ngModel)]="filtroFechaInicio"
          (dateChange)="aplicarFiltros()"
          placeholder="MM/DD/YYYY llegada"
        />
        <input
          matEndDate
          [(ngModel)]="filtroFechaFin"
          (dateChange)="aplicarFiltros()"
          placeholder="MM/DD/YYYY salida"
        />
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>

    <button class="btn-eliminar" (click)="limpiarFiltros()">
      Limpiar Filtros
    </button>
  </div>

  @if(huespedResponseFiltrados.length == 0){
  <div class="no-users-message">
    <h2>No hay huéspedes registrados</h2>
  </div>
  }

  <div class="tabla-container">
    <table class="habitacion-table">
      <thead>
        <tr>
          <th>Hab.</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Telefono</th>
          <th>No.Per</th>
          <th>Monto</th>
          <th>Estado</th>
          <th>Fecha Ingreso</th>
          <th>Fecha Salida</th>
          <th>Usuario</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for(h_Response of huespedResponseFiltrados; track
        h_Response.idHuesped){
        <tr>
          <td style="color: red">
            {{ h_Response.habitacionAsignada.id_Rooms }}
          </td>
          <td>{{ h_Response.nameHuesped }}</td>
          <td>{{ h_Response.apellidoHuesped }}</td>
          <td>{{ h_Response.telefono }}</td>
          <td>{{ h_Response.numPersonas }}</td>
          <td>{{ h_Response.monto| currency : "Q" : "symbol" : "1.2-2" }}</td>
          <td>{{ h_Response.statusHuesped }}</td>
          <td>{{ h_Response.fechaRegistro | date : "dd/MM/yyyy" }}</td>
          <td>{{ h_Response.fechaSalida | date : "dd/MM/yyyy" }}</td>
          <td>{{ h_Response.usuarioRegistrador.name }}</td>
          <td class="acciones-cell">
            <div class="btn-group">
              <button
                class="btn-editar"
                (click)="
                  editarHuesped(
                    h_Response,
                    h_Response.habitacionAsignada.id_Rooms
                  )
                "
              >
                Editar
              </button>
              <button
                class="btn-eliminar"
                (click)="delete(h_Response.idHuesped)"
              >
                Eliminar
              </button>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
   <!-- <button class="btn-editar" routerLink='/SACH/RegistroHuesped' matTooltip="Registrar nuevo huésped" matTooltipPosition="above" matTooltipClass="tooltip">
                <mat-icon>add</mat-icon
              
              >
                Reservacion
              </button> -->
</div>
